<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <!-- importing mapbox JS and CSS-->
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' rel='stylesheet' />
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.2.0/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.2.0/mapbox-gl-geocoder.css' type='text/css' />
    <!-- importing bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <!-- importing our own CSS -->
    <link rel="stylesheet" href="./static/css/index.css" /> 
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
  </head>
  <body>

    <!-- navbar container -->
    <nav class="navbar navbar-dark bg-dark">
      <span class="navbar-brand">Historic Traffic Incidents and Delays</span>
      <ul class="navbar-nav ml-auto">
        <li class="nav-item"><a class="nav-link" data-toggle="modal" data-target="#aboutModal">About</a></li>
      </ul>
    </nav>

    <!-- spinner -->
    <div class="loader" id="loader"></div>

    <!-- map container -->
    <div id="map"></div>

    <!-- filters container -->
    <div class="filter-overlay">
      <div class="container">
        <div class="panel-group">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <a data-toggle="collapse" href="#collapse1">Filters:</a>
              </h4>
            </div>
            <div id="collapse1" class="panel-collapse collapse show">
              <!-- traffic severity -->
              <div class="row filter-title">
                <div class="col">
                  <label class="form-check-label">Traffic Severity</label>
                </div>
              </div>
              <!-- traffic severity checkboxes -->
              <div class="row">
                <div class="col">
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="checkbox-severity-1" value="1" checked>
                    <label class="form-check-label" for="checkbox-severity-1">1<span style="color: #edf8fb;">&#9632;</span></label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="checkbox-severity-2" value="2" checked>
                    <label class="form-check-label" for="checkbox-severity-2">2<span style="color: #b3cde3;">&#9632;</span></label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="checkbox-severity-3" value="3" checked>
                    <label class="form-check-label" for="checkbox-severity-3">3<span style="color: #8c96c6;">&#9632;</span></label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="checkbox-severity-4" value="4" checked>
                    <label class="form-check-label" for="checkbox-severity-4">4<span style="color: #88419d;">&#9632;</span></label>
                  </div>
                </div>
              </div>

              <!-- hour of day -->
              <div class="row filter-title">
                <div class="col">
                  <label class="form-check-label">Hour of Day</label>
                </div>
              </div>

              <!-- hour of day -->
              <div class="row">
                <div class="col">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="checkbox-hour" value="">
                    <label class="form-check-label" for="checkbox-hour">
                      Enabled
                    </label>
                  </div>
                </div>
              </div>

              <!-- hour of day slider -->
              <div class="row" id="hour-slider">
                <div class="col text-center">
                  <input id='time-slider' class='form-control-range' type='range' min='0' max='23' step='1' value='12' />
                  <!-- use this slider option if you want 3 hr time increments instead -->
                  <!-- <input id='time-slider' class='form-control-range' type='range' min='0' max='21' step='3' value='12' /> -->
                  <label id='active-hour'>12PM</label>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- About modal -->
    <div class="modal fade" id="aboutModal">
      <div class="modal-dialog modal-md">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">About</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Click anywhere on the map to predict incident severity at that location.  Click-and-drag the map to browse historic traffic incident data.  Hover over an individual point to see details.</p>
            <p>Data Source: <a href="https://smoosavi.org/datasets/us_accidents" target="_blank">A Countrywide Traffic Accident Dataset</a></p>
            Brought to you by these lovely people:
            <ul>
              <li>Bryan Cheung</li>
              <li>Daniel Do</li>
              <li>Jason Harris</li>
              <li>Mark Nassar</li>
              <li>Keegan Valerio</li>
              <li>Rui-Jia (Richard) Zhang</li>
            </ul>
          </div>
        </div>
      </div>
    </div>


    <!-- modal for predictionm -->
    <div class="modal fade" id="predictionModal">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Predict Traffic Delay Severity</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <!-- main form container -->
            <div class="container">
              <!-- row for input boxes and stuff -->
              <div class="row">
                <div class="col-sm-3">
                  <div class="form-group">
                    <label for="lat">Latitude:</label>
                    <input class="form-control" type="text" id="lat" readonly> 
                    <a href="#" class="link form-text text-muted" data-dismiss="modal"><small>Select on map</small></a>
                  </div>
                  <div class="form-group">
                    <label for="lon">Longitude:</label>
                    <input class="form-control" type="text" id="lon" readonly>
                    <a href="#" class="link form-text text-muted" data-dismiss="modal"><small>Select on map</small></a>
                  </div>
                  <div class="form-group">
                    <label for="ms">Prediction Model:</label>
                    <select class="form-control" id="ms">
                      <option value='Random_Forest'>Random Forest</option>
                      <option value='KNN'>KNN</option>
                      <option value='Decision_Tree'>Decision Tree</option>
                    </select>
                  </div>
                </div>
                <div class="col-sm-3">
                  <div class="form-group">
                    <label class="control-label" for="date">Weather Forecast:</label>
                    <div class="form-row" class="input-group date">
                      <input type="text" class="form-control" id="datepicker" placeholder="MM/DD/YYYY">
                      <div class="input-group-addon">
                        <span class="glyphicon glyphicon-th"></span>
                      </div>
                      <script type="text/javascript">
                        $("#datepicker").datepicker({
                          format: 'mm/dd/yyyy', 
                          maxViewMode: 0,
                          startDate: "0",
                          todayHighlight: true,
                          endDate: "+6d",
                          toggleActive: false,
                        });
                        $('#datepicker').datepicker().on('changeDate', function () {Forecast(current=false)});
                      </script>
                    </div>
                  </div>
                  <div>
                    <button onclick="Forecast(current=true)" type="Forecast" class="btn btn-secondary" id="Current_Conditions">Current Conditions</button>
                    <script type="text/javascript">
                      $("#Current_Conditions").click(function(){
                          $('#datepicker').val("");
                      })
                    </script>
                  </div>
                  <small class="form-text text-muted"><br> </small>
                  <small class="form-text text-muted">Weather data autofills with current conditions based on selected point. </small>
                  <small class="form-text text-muted"><br> </small>
                  <small class="form-text text-muted">Selecting a future date will autofill the forecasted weather (up to 7 days). </small>
                </div>
                <div class="col-sm-3">
                  <div class="form-group">
                    <label for="temp">Temperature (&degF):</label>
                    <input class="form-control" id="temp" type="number"  step="0.01">
                    <small class="form-text text-muted">Any number</small>
                  </div>
                  <div class="form-group">
                    <label for="wc">Wind Chill (&degF):</label>
                    <input class="form-control" id="wc" type="number" step="0.01">
                    <small class="form-text text-muted">Any Number</small>
                  </div>
                  <div class="form-group">
                    <label for="prep">Precipitation (in):</label>
                    <input class="form-control" id="prep" type="number", min="0" step="0.01">
                    <small class="form-text text-muted">Number greater than 0</small>
                  </div>
                </div>
                <div class="col-sm-3">
                  <div class="form-group">
                    <label for="vis">Visibility (miles):</label>
                    <input class="form-control" id="vis" type="number" min="0" max="10", step="0.01">
                    <small class="form-text text-muted">Number from 0 to 10</small>
                  </div>
                  <div class="form-group">
                    <label for="hum">Humidity (%):</label>
                    <input class="form-control" id="hum" type="number", min="0", max="100">
                    <small class="form-text text-muted">Number from 0 to 100</small>
                  </div>
                  <div class="form-group">
                    <label for="pres">Pressure (inHg):</label>
                    <input class="form-control" id="pres" type="number", step="0.01", min="0">
                    <small class="form-text text-muted">Number greater than 0</small>
                  </div>
                </div>
              </div>
            </div> <!-- end form container -->
          </div> <!-- end modal body -->
          <div class="modal-footer justify-content-between">
            <div class="row">
              <label for="sev" class="col-sm-4.1 col-form-label">Predicted Severity:</label>
              <div class="col-sm-3">
                <div class="loader2" id="loader2"></div>
                <input class="form-control" type="text" id="sev" style='text-align: center' readonly>
              </div>
            </div>
            <div>
              <button onclick="Submit()" type="submit" class="btn btn-primary">Predict</button>
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- including page scripts here (jquery, bootstrap, our own draw-map js) -->
    <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <script src='./static/js/draw-map.js'></script>
  </body>
</html>
